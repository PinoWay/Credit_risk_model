# Модель кредитного риск менеджмента

Банки используют модели кредитного риск-менеджмента, чтобы понимать,
насколько можно доверять клиенту в выполнении обязательств по договорам
кредитования. Когда клиент заполняет заявку на кредит или ипотеку,
его оценивают по модели кредитного риск-менеджмента. Банк может
использовать разные сведения: например, о месте работы, возрасте, истории
предыдущих погашений по другим кредитам в банках и кредитных
организациях. На основе этой информации модель машинного обучения
подсказывает кредитному менеджеру, стоит ли доверять клиенту запрашиваемую
сумму денег.

С помощью такой автоматизации банк экономит время своих специалистов,
чтобы они не искали и не агрегировали информацию по каждому клиенту для
принятия решения о выдаче кредита. Это ускоряет время подтверждения
заявки на кредит. Однако в отдельных случаях специалисты могут экспертно
проверить решение модели, чтобы проаудировать её и выявить возможные
слабые места.

В данном репозитарии представлено построение различных классических моделей машинного обучения и их ансамблей для решения задачи рценки вероятности выхода клиента банка в дефолт (непогашение займа).

## Структура репозитория
- data
    - train_data_0.pq - файл, содержащий информацию об атритутах заемщиков
    - train_target.csv - файл, содержащий целевую метрику (1 - клинет вышел в дефолт, 0 - клиент не вышел в дефолт).
- best_pipe.pkl - итоговый пайплайн обработки данных и определения вероятности выхода клиента в дефолт с использованием лучшей модели машинного обучения из рассмотренных.
- Modeling.ipynb - ноутбук с обучением и валидацией моделей.

## Описание датасета
Данные содержат информацию о различных атрибутах заёмщиков
и кредитных продуктов: о клиентах, которые уже имеют кредиты, их
кредитной истории и финансовых показателях. Каждая запись в датасете
представляет один конкретный кредитный продукт, выданный конкретному
заёмщику.

* id — идентификатор заявки. Заявки пронумерованы так, что большему
номеру соответствует более поздняя дата заявки.
* rn — порядковый номер кредитного продукта в кредитной истории.
Большему номеру соответствует продукт с более поздней датой открытия.
* pre_since_opened — количество дней с даты открытия кредита до даты
сбора данных (бинаризовано*).
* pre_since_confirmed — количество дней с даты подтверждения
информации по кредиту до даты сбора данных (бинаризовано*).
* pre_pterm — плановое количество дней с даты открытия кредита до даты
закрытия (бинаризовано*).
* pre_fterm — фактическое количество дней с даты открытия кредита до
даты закрытия (бинаризовано*).
* pre_till_pclose — плановое количество дней с даты сбора данных до даты
закрытия кредита (бинаризовано*).
* pre_till_fclose — фактическое количество дней с даты сбора данных до
даты закрытия кредита (бинаризовано*).
* pre_loans_credit_limit — кредитный лимит (бинаризовано*).
* pre_loans_next_pay_summ — сумма следующего платежа по кредиту
(бинаризовано*).
* pre_loans_outstanding — оставшаяся невыплаченная сумма кредита
(бинаризовано*).
* pre_loans_total_overdue — текущая просроченная задолженность
(бинаризовано*).
* pre_loans_max_overdue_sum — максимальная просроченная
задолженность (бинаризовано*).
* pre_loans_credit_cost_rate — полная стоимость кредита (бинаризовано*).
* pre_loans5 — число просрочек до 5 дней (бинаризовано*).
* pre_loans530 — число просрочек от 5 до 30 дней (бинаризовано*).
* pre_loans3060 — число просрочек от 30 до 60 дней (бинаризовано*).
* pre_loans6090 — число просрочек от 60 до 90 дней (бинаризовано*).
* pre_loans90 — число просрочек более чем на 90 дней (бинаризовано*).
* is_zero_loans_5 — флаг: нет просрочек до 5 дней.
* is_zero_loans_530 — флаг: нет просрочек от 5 до 30 дней.
* is_zero_loans_3060 — флаг: нет просрочек от 30 до 60 дней.
* is_zero_loans_6090 — флаг: нет просрочек от 60 до 90 дней.
* is_zero_loans90 — флаг: нет просрочек более чем на 90 дней.
* pre_util — отношение оставшейся невыплаченной суммы кредита
к кредитному лимиту (бинаризовано*).
* pre_over2limit — отношение текущей просроченной задолженности
к кредитному лимиту (бинаризовано*).
* pre_maxoer2limit — отношение максимальной просроченной
задолженности к кредитному лимиту (бинаризовано*).
* is_zero_util — флаг: отношение оставшейся невыплаченной суммы
кредита к кредитному лимиту равно 0.
* is_zero_oer2limit — флаг: отношение текущей просроченной
задолженности к кредитному лимиту равно 0.
* is_zero_maxoer2limit — флаг: отношение максимальной просроченной
задолженности к кредитному лимиту равно 0.
* enc_paym_{0..N} — статусы ежемесячных платежей за последние N
месяцев (закодировано**).
* enc_loans_account_holder_type — тип отношения к кредиту
(закодировано**).
* enc_loans_credit_status — статус кредита (закодировано**).
* enc_loans_account_cur — валюта кредита (закодировано**).
* enc_loans_credit_type — тип кредита (закодировано**).
* pclose_flag — флаг: плановое количество дней с даты открытия кредита
до даты закрытия не определено.
* fclose_flag — флаг: фактическое количество дней с даты открытия
кредита до даты закрытия не определено.

\* область значений поля разбивается на N непересекающихся промежутков, каждому промежутку случайным образом ставится в соответствие уникальный номер от 0 до N-1, значение поля заменяется номером промежутка, которому оно принадлежит  

\** каждому уникальному значению поля случайным образом ставится в соответствие уникальный номер от 0 до K, значение поля заменяется номером этого значения

## Итоги моделирования
Из всех рассмотренных моделей, лучшей метрикой roc auc (0.756) на тестовых данных обладает модель голосования, включающая в себя модель логистической регрессии, модель случайного леса и модель экстримального градиентного бустинга.